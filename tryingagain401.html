<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Send Data to Excel</title>
</head>
<body>
    <h1>Sending Data to Excel...</h1>

    <script>
        const productDetailsFixed = {
            ProductNumber: "1234",
            SerialNumber: "5678",
            ProductName: "Example Product"
        };

        const regionMappings = [
            { name: "Dresden, Germany", latRange: [50.0, 52.0], lonRange: [12.0, 14.5] },
            { name: "Woodlands, Singapore", latRange: [1.2, 1.6], lonRange: [103.5, 104.0] },
            { name: "Beaverton, USA", latRange: [45.0, 46.0], lonRange: [-123.5, -122.0] },
            { name: "Taiwan", latRange: [22.0, 26.0], lonRange: [119.0, 123.0] }
        ];

        function findRegionName(latitude, longitude) {
            for (const region of regionMappings) {
                if (latitude >= region.latRange[0] && latitude <= region.latRange[1] &&
                    longitude >= region.lonRange[0] && longitude <= region.lonRange[1]) {
                    return region.name;
                }
            }
            return "Unknown Area";
        }

        function sendDataToPowerAutomate(data) {
            const flowURL = "
